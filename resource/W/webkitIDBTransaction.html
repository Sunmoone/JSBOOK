<div class="_page _mdn"><h1>IDBTransaction</h1> <div class="summary"> <p>The <code>IDBTransaction</code> interface of the <a href="https://developer.mozilla.org/en-US/docs/IndexedDB">IndexedDB API</a> provides a static, asynchronous transaction on a database using event handler attributes. All reading and writing of data are done within transactions. You actually use <a href="idbdatabase" title="Everything you do in IndexedDB always happens in the context of a transaction, representing interactions with data in the database. All objects in IndexedDB—including object stores, indexes, and cursors—are tied to a particular transaction. Thus, you cannot execute commands, access data, or open anything outside of a transaction."><code>IDBDatabase</code></a> to start transactions and use <a href="idbtransaction" title="Inherits from: EventTarget"><code>IDBTransaction</code></a> to set the mode of the transaction and access an object store and make your request. You can also use it to abort transactions.</p> </div> <h2 id="Methods">Methods</h2> <p>Inherits from: <a href="eventtarget" title="EventTarget is a DOM interface implemented by objects that can receive DOM events and have listeners for them."><code>EventTarget</code></a></p> <dl>
<dt> <a href="idbtransaction.abort" title="All pending IDBRequest objects created during this transaction have their error attributre set to AbortError."><code>IDBTransaction.abort</code></a>
</dt> <dd> Returns immediately, and rolls back all the changes to objects in the database associated with this transaction. If this transaction has been aborted or completed, then this method throws an error event.</dd> <dt> <a href="idbtransaction.objectstore" title="Every call to this method on the same transaction object, with the same name, returns the same IDBObjectStore instance. If this method is called on a different transaction object, a different IDBObjectStore instance is returned."><code>IDBTransaction.objectStore</code></a>
</dt> <dd> Returns an <a href="idbobjectstore" title="To learn more about various topics, see the following"><code>IDBObjectStore</code></a> representing an <span class="internalDFN">object store</span> that is part of the <span class="internalDFN">scope</span> of this <span class="internalDFN">transaction</span>.</dd> </dl><h2 id="Properties">Properties</h2> <dl>
<dt> <a href="idbtransaction.db" title="An IDBDatabase object."><code>IDBTransaction.db</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd> The database connection with which this transaction is associated.</dd> <dt> <a href="idbtransaction.mode" title="An IDBTransactionMode object defining the mode for isolating access to data in the current object stores:"><code>IDBTransaction.mode</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd> The mode for isolating access to data in the object stores that are in the scope of the transaction. For possible values, see Constants. The default value is <code><a href="#const_read_only">readonly</a></code>.</dd> <dt> <a href="idbtransaction.error" title="This is null if the transaction is not finished, is finished and successfully committed, or was aborted with the IDBTransaction.abort method. It returns the same DOMError as the request object that caused the transaction to be aborted due to a failed request, or a DOMError for the transaction failure not due to a failed request (such as QuotaExceededError or UnknownError)."><code>IDBTransaction.error</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd> The error returned in the event of an unsuccessful transaction. Null if the transaction is not finished, is finished and successfully committed, or was aborted with <a href="idbtransaction.abort" title="All pending IDBRequest objects created during this transaction have their error attributre set to AbortError."><code>IDBTransaction.abort</code></a> function. Returns the same DOMError as the request object which caused the transaction to be aborted due to a failed request, or a DOMError for the transaction failure not due to a failed request (such as <code>QuotaExceededError</code> or <code>UnknownError</code>).</dd> </dl><h3 id="Event_handlers">Event handlers</h3> <dl>
<dt> <a href="idbtransaction.onabort" title="The documentation about this has not yet been written; please consider contributing!"><code>IDBTransaction.onabort</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd> The event handler for the <code>onabort</code> event.</dd> <dt> <a href="idbtransaction.oncomplete" title="The documentation about this has not yet been written; please consider contributing!"><code>IDBTransaction.oncomplete</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd> The event handler for the <code>oncomplete</code> event.</dd> <dt> <a href="idbtransaction.onerror" title="The documentation about this has not yet been written; please consider contributing!"><code>IDBTransaction.onerror</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd> The event handler for the <code>onerror</code> event.</dd> </dl><h2 id="Constants" name="Constants">Mode constants</h2> <div class="overheadIndicator obsolete obsoleteHeader"><p><strong>Obsolete since Gecko 25 (Firefox 25 / Thunderbird 25 / SeaMonkey 2.22)</strong><br>This feature is obsolete. Although it is still supported by browsers, its usage is discouraged in new projects. Try to avoid using it.</p></div> <div class="warning"> <p>These constants are no longer available. You should use the direct string constants instead. (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=888598" title="FIXED: Move IDBTransaction to WebIDL">bug 888598</a>)</p> </div> <p>Transactions can have one of three modes:</p> <table class="standard-table">
<thead><tr>
<th scope="col">Constant</th> <th scope="col">Value</th> <th scope="col">Description</th> </tr></thead>
<tbody>
<tr>
<td><code><a name="const_read_only">READ_ONLY</a></code></td> <td> <p>"readonly"</p> <p>(0 in Chrome)</p> </td> <td> <p>Allows data to be read but not changed.</p> </td> </tr>
<tr>
<td><code><a name="const_read_write">READ_WRITE</a></code></td> <td> <p>"readwrite"</p> <p>(1 in Chrome)</p> </td> <td>Allows reading and writing of data in existing data stores to be changed.</td> </tr>
<tr>
<td><code><a name="VERSION_CHANGE">VERSION_CHANGE</a></code></td> <td> <p>"versionchange"</p> <p>(2 in Chrome)</p> </td> <td>Allows any operation to be performed, including ones that delete and create object stores and indexes. This mode is for updating the version number of transactions that were started using the <a href="https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabase#setVersion"><code>setVersion()</code></a> method of <a href="https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabase">IDBDatabase</a> objects. Transactions of this mode cannot run concurrently with other transactions.</td> </tr>
</tbody>
</table><p>Even if these constants are now deprecated, you can still use them to provide backward compatibility if required (in Chrome <a href="http://peter.sh/2012/05/tab-sizing-string-values-for-indexeddb-and-chrome-21/">the change was made in version 21</a>). You should code defensively in case the object is not available anymore:</p> <pre class=" language-javascript"><span class="token keyword">var</span> myIDBTransaction <span class="token operator">=</span> window<span class="token punctuation">.</span>IDBTransaction <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitIDBTransaction <span class="token operator">||</span> <span class="token punctuation">{</span> READ_WRITE<span class="token punctuation">:</span> <span class="token string">"readwrite"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></pre> <h2 id="Example">Example</h2> <p>In the following code snippet, we open a read/write transaction on our database and add some data to an object store. Note also the functions attached to transaction event handlers to report on the outcome of the transaction opening in the event of success or failure.</p> <pre class=" language-javascript"><span class="token comment" spellcheck="true">// Let us open our database
</span><span class="token keyword">var</span> request <span class="token operator">=</span> window<span class="token punctuation">.</span>indexedDB<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">"toDoList"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">
// store the result of opening the database in the db variable.
</span>db <span class="token operator">=</span> request<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// Create a new object ready for being inserted into the IDB
</span><span class="token keyword">var</span> newItem <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> taskTitle<span class="token punctuation">:</span> <span class="token string">"Walk dog"</span><span class="token punctuation">,</span> hours<span class="token punctuation">:</span> <span class="token number">19</span><span class="token punctuation">,</span> minutes<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> day<span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span> month<span class="token punctuation">:</span> <span class="token string">"December"</span><span class="token punctuation">,</span> year<span class="token punctuation">:</span> <span class="token number">2013</span><span class="token punctuation">,</span> notified<span class="token punctuation">:</span> <span class="token string">"no"</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// open a read/write db transaction, ready for adding the data
</span><span class="token keyword">var</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">"toDoList"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"readwrite"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// report on the success of opening the transaction
</span>transaction<span class="token punctuation">.</span>oncomplete <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  note<span class="token punctuation">.</span>innerHTML <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;li&gt;Transaction opened for task addition.&lt;/li&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

transaction<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  note<span class="token punctuation">.</span>innerHTML <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;li&gt;Transaction not opened due to error. Duplicate items not allowed.&lt;/li&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// create an object store on the transaction
</span><span class="token keyword">var</span> objectStore <span class="token operator">=</span> transaction<span class="token punctuation">.</span><span class="token function">objectStore<span class="token punctuation">(</span></span><span class="token string">"toDoList"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// add our newItem object to the object store
</span><span class="token keyword">var</span> request <span class="token operator">=</span> objectStore<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span>newItem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

request<span class="token punctuation">.</span>onsuccess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true"> // report the success of our new item going into the database
</span>  note<span class="token punctuation">.</span>innerHTML <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;li&gt;New item added to database.&lt;/li&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre> <h2 id="issues" name="issues">Known browser issues</h2> <p>Older versions of <strong>Google Chrome</strong> serialize all transactions. So even if you have only read-only transactions and no read-write transaction, your transactions are executed one at a time. Any subsequent transactions are not executed until read-only transactions are completed. For the status, see <a href="http://code.google.com/p/chromium/issues/detail?id=64076">bug 64076</a>.</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"><tbody>
<tr>
<th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr>
<tr>
<td><a class="external" href="https://dvcs.w3.org/hg/IndexedDB/raw-file/tip/Overview.html#transaction" lang="en" title="The definition of 'IDBTransaction' in that specification.">Indexed Database API</a></td> <td><span class="spec-CR">Candidate Recommendation</span></td> <td> </td> </tr>
</tbody></table><h2 id="Browser_compatibility" name="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"><tbody>
<tr>
<th><code>Feature</code></th> <th><code>Chrome</code></th> <th><code>Firefox (Gecko)</code></th> <th><code>Internet Explorer</code></th> <th><code>Opera</code></th> <th><code>Safari (WebKit)</code></th> </tr>
<tr>
<td>Basic support</td> <td>12<code><span class="inlineIndicator prefixBox prefixBoxInline" title="prefix">-webkit</span></code><br> 21<br> </td> <td><code>4.0 (2.0)</code></td> <td>10</td> <td>17</td> <td><code><span style="color: #f00;">Not supported</span></code></td> </tr>
</tbody></table>
</div> <div id="compat-mobile"> <table class="compat-table"><tbody>
<tr>
<th><code>Feature</code></th> <th><code>Android</code></th> <th><code>Firefox Mobile (Gecko)</code></th> <th>Firefox OS</th> <th><code>IE Phone</code></th> <th><code>Opera Mobile</code></th> <th><code>Safari Mobile</code></th> </tr>
<tr>
<td>Basic support</td> <td>4.4</td> <td><code>6.0 (6.0)</code></td> <td>1.0.1</td> <td>10</td> <td>17</td> <td><code><span style="color: #f00;">Not supported</span></code></td> </tr>
</tbody></table>
</div> <div class="warning"> <p>Be careful in Chrome as it still implements the old specification along the new one. Similarly it still has the prefixed <code>webkitIndexedDB</code> property even if the unprefixed <code>indexedDB</code> is present.</p> </div> <h2 id="See_also">See also</h2> <p>To learn more about various topics, see the following</p> <ul>
<li>Starting transactions: <a href="idbdatabase" title="Everything you do in IndexedDB always happens in the context of a transaction, representing interactions with data in the database. All objects in IndexedDB—including object stores, indexes, and cursors—are tied to a particular transaction. Thus, you cannot execute commands, access data, or open anything outside of a transaction."><code>IDBDatabase</code></a>
</li> <li>Setting a range of keys: <a href="idbkeyrange" title="A key range can have a single value or a range with upper and lower bounds or endpoints. If the key range has both upper and lower bounds, then it is bounded; if it has no bounds, it is unbounded. A bounded key range can either be open (the endpoints are excluded) or closed (the endpoints are included). To retrieve all keys within a certain range, you can use the following code constructs:"><code>IDBKeyRange</code></a>
</li> <li>Creating cursors: <a href="idbindex" title="You can retrieve records in an object store through their keys or by using an index (cursors provide a third way: see IDBCursor). An index lets you look up records in an object store using properties of the values in the object stores records."><code>IDBIndex</code></a>
</li> <li>The reference application for the examples in this reference: <a class="external" href="https://github.com/chrisdavidmills/to-do-notifications/tree/gh-pages">To-do Notifications</a> (<a class="external" href="http://chrisdavidmills.github.io/to-do-notifications/">view example live</a>.) Not every snippet appears in this example, but every example uses the same data structure and syntax, and they will make sense in the context of this example.</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBTransaction$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013 Mozilla Contributors<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBTransaction" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/IDBTransaction</a>
  </p>
</div>
</div>