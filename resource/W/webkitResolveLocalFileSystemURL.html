<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/mnight/archive/2013/04/24/3040641.html">HTML5中的FileSystem API-空间的操作</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><p><span style="font-size: 14px;">HTML5的强大之一就是允许web程序申请一些临时或者永久的空间（Quota）在这里可以进行 数据的存储甚至文件的操作。</span></p>
<p><span style="font-size: 14px;">FileSystem提供了文件夹和文件的创建、移动、删除等操作，大大方便了数据的本地处理， 而且所有的数据都是在沙盒(sandboxed)中，不同的web程序不能互相访问，这就保证了数据 的完整和安全。</span></p>
<p><span style="font-size: 14px;">在CatWrite项目中，运用了HTML5的这个特性进行数据的存储，很是方便，只是目前来说只有 Chrome浏览器对FileSystem API支持的比较好，所以只能运行在Chrome浏览器中。</span></p>
<p><span style="font-size: 14px;">在完成这个功能的时候，查阅了很多资料，有一些资料是一年前的，但是随着浏览器版本的 变化，一些代码已经老化，在这里一一总结和整理。这里只列举了项目中用到的API，算是 对完成功能的一次梳理。</span></p>
<h3>申请空间</h3>
<p><span style="font-size: 14px;">为了进行数据的存储，必须要向浏览器进行申请，如果是永久存储还会向用户进行询问，只有 同意后才会继续执行。</span></p>
<p><span style="font-size: 14px;">首先必须要声明想要的权限。</span></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_635370" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem; </code><code class="javascript comments">//文件系统请求标识</code></div><div class="line number2 index1 alt1"><code class="javascript plain">window.resolveLocalFileSystemURL = window.resolveLocalFileSystemURL || window.webkitResolveLocalFileSystemURL; </code><code class="javascript comments">//根据URL取得文件的读取权限</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
<!--more-->
<p><span style="font-size: 14px;">得到系统的权限后就可以向浏览器申请空间</span></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_651646" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">window.requestFileSystem(window.PERSISTENT, </code><code class="javascript comments">//persistent(永久) or temporary(临时)</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">1024*1024, </code><code class="javascript comments">//1M</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">onInitFs,&nbsp; </code><code class="javascript comments">//成功后的回调函数</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">errorHandler);&nbsp; </code><code class="javascript comments">//错误后的回调函数</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
<p><span style="font-size: 14px;">回调函数</span></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_710422" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">onInitFs(fs){</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">fs.root.getDirectory(</code><code class="javascript string">'catwrite_documents'</code><code class="javascript plain">, {create: </code><code class="javascript keyword">true</code><code class="javascript plain">}, </code><code class="javascript keyword">function</code><code class="javascript plain">(dirEntry) {</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">'You have just created the '</code> <code class="javascript plain">+ dirEntry.name + </code><code class="javascript string">' directory.'</code><code class="javascript plain">);</code></div><div class="line number4 index3 alt1"><code class="javascript plain">}, errorHandler); </code></div><div class="line number5 index4 alt2"><code class="javascript plain">}</code></div><div class="line number6 index5 alt1"><code class="javascript comments">//错误回调</code></div><div class="line number7 index6 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">errorHandler(err){</code></div><div class="line number8 index7 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">var</code> <code class="javascript plain">msg = </code><code class="javascript string">'An error occured: '</code><code class="javascript plain">;</code></div><div class="line number9 index8 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">switch</code> <code class="javascript plain">(err.code) {</code></div><div class="line number10 index9 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">case</code> <code class="javascript plain">FileError.NOT_FOUND_ERR:</code></div><div class="line number11 index10 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">msg += </code><code class="javascript string">'File or directory not found'</code><code class="javascript plain">;</code></div><div class="line number12 index11 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">break</code><code class="javascript plain">;</code></div><div class="line number13 index12 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">case</code> <code class="javascript plain">FileError.NOT_READABLE_ERR:</code></div><div class="line number14 index13 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">msg += </code><code class="javascript string">'File or directory not readable'</code><code class="javascript plain">;</code></div><div class="line number15 index14 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">break</code><code class="javascript plain">;</code></div><div class="line number16 index15 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">case</code> <code class="javascript plain">FileError.PATH_EXISTS_ERR:</code></div><div class="line number17 index16 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">msg += </code><code class="javascript string">'File or directory already exists'</code><code class="javascript plain">;</code></div><div class="line number18 index17 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">break</code><code class="javascript plain">;</code></div><div class="line number19 index18 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">case</code> <code class="javascript plain">FileError.TYPE_MISMATCH_ERR:</code></div><div class="line number20 index19 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">msg += </code><code class="javascript string">'Invalid filetype'</code><code class="javascript plain">;</code></div><div class="line number21 index20 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">break</code><code class="javascript plain">;</code></div><div class="line number22 index21 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">default</code><code class="javascript plain">:</code></div><div class="line number23 index22 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">msg += </code><code class="javascript string">'Unknown Error'</code><code class="javascript plain">;</code></div><div class="line number24 index23 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">break</code><code class="javascript plain">;</code></div><div class="line number25 index24 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">};</code></div><div class="line number26 index25 alt1"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">console.log(msg + err);</code></div><div class="line number27 index26 alt2"><code class="javascript plain">}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
<p><span style="font-size: 14px;">如果成功后悔调用OnInitFs回调函数，在里面用了getDirectory方法用来创建一个文件夹，这下面再说。</span></p>
<p><span style="font-size: 14px;">但是这是有个问题，这样做的话每次加载页面都会申请，这肯定不是我们想要的，我们要 的是在有数据的时候就可以读取数据。</span></p>
<h3>判断是否申请过空间</h3>
<p>所以我们需要读取浏览器的数据，看看是否已有存储。这就用到了另一个API：</p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_47318" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">void queryUsageAndQuota(</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">in</code> <code class="javascript plain">DOMString url, </code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">in</code> <code class="javascript plain">EntryCallback successCallback, </code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">in</code> <code class="javascript plain">optional ErrorCallback errorCallback</code></div><div class="line number5 index4 alt2"><code class="javascript plain">);</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
<p><span style="font-size: 14px;">这个API可以查询当前web的空间情况，如果成功的话就会调用successCallback回调函数 并把已用空间和全部空间作为参数传入方法中。如果失败则调去errorCallback。</span></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_691480" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">window.webkitStorageInfo.queryUsageAndQuota(webkitStorageInfo.PERSISTENT,</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">function</code><code class="javascript plain">(used, remaining){</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">if</code><code class="javascript plain">(remaining == </code><code class="javascript string">""</code><code class="javascript plain">){</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">"未申请空间。"</code><code class="javascript plain">);</code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code><code class="javascript keyword">else</code><code class="javascript plain">{</code></div><div class="line number6 index5 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">"已使用空间"</code><code class="javascript plain">+used);</code></div><div class="line number7 index6 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">"全部空间"</code><code class="javascript plain">+remaining);</code></div><div class="line number8 index7 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number9 index8 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">},</code></div><div class="line number10 index9 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">errorHandler);</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
<p><span style="font-size: 14px;">我们可以通过判断remaining参数来判断是否有申请空间，如果没有申请，则返回上一步申请空间。 如果已经有空间的话，则需要得到空间的跟文件，这样才能操作数据。</span></p>
<h3>获取文件入口</h3>
<p><span style="font-size: 14px;">FileSystem使用了特殊的文件系统和沙盒模式，在电脑上或者其他web中是无法访问沙盒中的文件的 ，只能用对应的格式去访问。</span></p>
<p><span style="font-size: 14px;">在浏览器中输入：</span></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_858439" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">filesystem:http:</code><code class="javascript comments">//catcoder.com/persistent/ </code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　　</p>
<p><span style="font-size: 14px;">这样可以访问catcoder.com这个网站在本机永久数据，把persistent换成temporary则是读取临时空间。</span></p>
<p><span style="font-size: 14px;">然后我们就可以通过URL和对应API获取文件的入口(Lets you look up the entry for a file or directory with a local URL)。</span></p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_236275" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">void resolveLocalFileSystemURL(</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">in</code> <code class="javascript plain">DOMString url, </code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">in</code> <code class="javascript plain">EntryCallback successCallback, </code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">in</code> <code class="javascript plain">optional ErrorCallback errorCallback</code></div><div class="line number5 index4 alt2"><code class="javascript plain">);</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>&nbsp;</p>
<p>　　</p>
<p>&nbsp;</p>
<p><span style="font-size: 14px;">下面就可以读取本机存储的数据了</span></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_129660" class="syntaxhighlighter nogutter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">url = </code><code class="javascript string">"filesystem:<a href="http://">http://</a>"</code> <code class="javascript plain">+ window.location.host + </code><code class="javascript string">"/persistent/catwrite_documents/"</code><code class="javascript plain">;</code></div><div class="line number2 index1 alt1"><code class="javascript plain">window.resolveLocalFileSystemURL(url,</code><code class="javascript keyword">function</code><code class="javascript plain">(fileEntry){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(fileEntry);</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">var</code> <code class="javascript plain">dirReader = fileEntry.createReader();</code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">var</code> <code class="javascript plain">readEntries = </code><code class="javascript keyword">function</code><code class="javascript plain">(){</code></div><div class="line number6 index5 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">dirReader.readEntries(</code><code class="javascript keyword">function</code><code class="javascript plain">(results){</code></div><div class="line number7 index6 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">if</code><code class="javascript plain">(!results.length){</code></div><div class="line number8 index7 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">create_file_title(</code><code class="javascript string">"默认文件"</code><code class="javascript plain">, </code><code class="javascript string">""</code><code class="javascript plain">);</code></div><div class="line number9 index8 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">"没有文件！"</code><code class="javascript plain">);</code></div><div class="line number10 index9 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code><code class="javascript keyword">else</code><code class="javascript plain">{</code></div><div class="line number11 index10 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">"读取到"</code> <code class="javascript plain">+ results.length + </code><code class="javascript string">"个文件"</code><code class="javascript plain">);</code></div><div class="line number12 index11 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">for</code><code class="javascript plain">(</code><code class="javascript keyword">var</code> <code class="javascript plain">i = 0; i &lt; results.length; i++){</code></div><div class="line number13 index12 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">console.log(results[i].name);</code></div><div class="line number14 index13 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">getFileContentByName(fileEntry, results[i].name);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number15 index14 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number16 index15 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number17 index16 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">},errorHandler);</code></div><div class="line number18 index17 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">};</code></div><div class="line number19 index18 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">readEntries();</code></div><div class="line number20 index19 alt1"><code class="javascript plain">},errorHandler);</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>　</p>
<p>原文链接：<a href="http://catcoder.com/2013/04/24/html5-filesystem-api-quota/">http://catcoder.com/2013/04/24/html5-filesystem-api-quota/</a></p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="blog_post_info"><div id="BlogPostCategory">分类: <a href="http://www.cnblogs.com/mnight/category/473943.html">html5</a></div>
<div id="EntryTag">标签: <a href="http://www.cnblogs.com/mnight/tag/HTML5/">HTML5</a></div>
<div id="green_channel">
绿色通道：
<a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(cb_entryId,cb_blogId,1);green_channel_success(this,'谢谢推荐！');">好文要顶</a>
<a id="green_channel_follow" onclick="c_follow();" href="javascript:void(0);">关注我</a>
<a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a><a id="green_channel_contact" href="http://space.cnblogs.com/msg/send/MNight" target="_blank">与我联系</a>
<a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="http://static.cnblogs.com/images/icon_weibo_24.png" alt=""></a>
</div>
<div id="digg_block">
<div id="author_profile">
<div id="author_profile_info" class="author_profile_info">
<a href="http://home.cnblogs.com/u/mnight/" target="_blank"><img src="http://pic.cnitblog.com/face/u128664.jpg" class="author_avatar" alt=""></a>
<div id="author_profile_detail" class="author_profile_info">
<a href="http://home.cnblogs.com/u/mnight/">MNight</a><br>
<a href="http://home.cnblogs.com/u/mnight/followees">关注 - 21</a><br>
<a href="http://home.cnblogs.com/u/mnight/followers">粉丝 - 12</a>
</div>
</div>
<div class="clear"></div>
<div id="author_profile_honor"></div>
<div id="author_profile_follow">
<a href="javascript:void(0);" onclick="c_follow();return false;">+加关注</a>
</div>
</div>
<div id="div_digg">										
	<div class="diggit" onclick="votePost(cb_entryId,'Digg')"> 
		<span class="diggnum" id="digg_count">0</span>
	</div>
	<div class="buryit" onclick="votePost(cb_entryId,'Bury')"> 
		<span class="burynum" id="bury_count">0</span>
	</div>
	<div class="clear"></div>	
	<div class="diggword" id="digg_tips">
    (请您对文章做出评价)
    </div>	
</div>
</div></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="http://www.cnblogs.com/mnight/archive/2013/04/19/3030942.html" class="p_n_p_prefix">« </a> 上一篇：<a href="http://www.cnblogs.com/mnight/archive/2013/04/19/3030942.html" title="发布于2013-04-19 15:57">CatWrite一个关于写作的web项目</a><br><a href="http://www.cnblogs.com/mnight/archive/2013/05/02/3055084.html" class="p_n_p_prefix">» </a> 下一篇：<a href="http://www.cnblogs.com/mnight/archive/2013/05/02/3055084.html" title="发布于2013-05-02 17:57">让textarea光标定位到最后</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2013-04-24 17:28</span> <a href="http://www.cnblogs.com/mnight/">MNight</a> 阅读(<span id="post_view_count">876</span>) 评论(<span id="post_comment_count">0</span>)  <a href="http://www.cnblogs.com/mnight/admin/EditPosts.aspx?postid=3040641" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(3040641);return false;">收藏</a></div>
	</div>
	
</div>