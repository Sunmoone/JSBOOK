<article id="wikiArticle">
                                          <p>Since we're using script to control <code>canvas</code> elements it's also very easy to make (interactive) animations. Unfortunately the canvas element was never designed to be used in this way (unlike Flash) so there are limitations.</p>
<p>由于我们是用脚本去操控 canvas 对象，这样要实现一些交互动画也是相当容易的。只不过，canvas 从来都不是专门为动画而设计的（不像 Flash），难免会有些限制。</p>
<p>Probably the biggest limitation is that once a shape gets drawn it stays that way. If we need to move it we have to redraw it and everything that was drawn before it. It takes a lot of time to redraw complex frames and the performance depends highly on the speed of the computer it's running on.</p>
<p>可能最大的限制就是图像一旦绘制出来，它就是一直保持那样了。如果需要移动它，我们不得不对所有东西（包括之前的）进行重绘。重绘是相当费时的，而且性能很依赖于电脑的速度。</p>
<h2 id=".E5.9F.BA.E6.9C.AC.E5.8A.A8.E7.94.BB.E7.9A.84.E6.AD.A5.E9.AA.A4_Basic_animation_steps">基本动画的步骤 Basic animation steps</h2>
<p>画一帧，你需要以下一些步骤：</p>
<ol> <li><strong>清空 canvas</strong><br> 除非接下来要画的内容会完全充满 canvas （例如背景图），否则你需要清空所有。最简单的做法就是用 <code>clearRect</code> 方法。</li> <li><strong>保存 canvas 状态</strong><br> 如果你要改变一些会改变 canvas 状态的设置（样式，变形之类的），又要在每画一帧之时都是原始状态的话，你需要先保存一下。</li> <li><strong>绘制动画图形（animated shapes）</strong><br> 这一步才是重绘动画帧。</li> <li><strong>恢复 canvas 状态</strong><br> 如果已经保存了 canvas 的状态，可以先恢复它，然后重绘下一帧。</li>
</ol><h2 id=".E6.93.8D.E6.8E.A7.E5.8A.A8.E7.94.BB_Controlling_an_animation">操控动画 Controlling an animation</h2>
<p>Shapes are drawn to the canvas by using the canvas methods directly or calling custom functions. In normal circumstances we only see these results appear on the canvas when the script finishes execution. For instance it isn't possible to do an animation from within a <code>for</code> loop.</p>
<p>在 canvas 上绘制内容是用 canvas 提供的或者自定义的方法，而通常，我们仅仅在脚本执行结束后才能看见结果，比如说，在 for 循环里面做完成动画是不太可能的。</p>
<p>We need a way to execute our drawing functions over a period of time. There are two ways to control an animation like this. First there's the <code>setInterval</code> and <code>setTimeout</code> functions which can be used to call a specific function over a set period of time.</p>
<p>我们需要一些可以定时的执行重绘的方法。有两种方法可以实现这样的动画操控。首先可以通过 <code>setInterval</code> 和 <code>setTimeout</code> 方法来控制在设定的时间点上执行重绘。</p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">setInterval<span class="token punctuation">(</span></span>animateShape<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout<span class="token punctuation">(</span></span>animateShape<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre>
<p>If you don't want any user interaction it's best to use the <code>setInterval</code> function which repeatedly executes the supplied code. In the example above the <code>animateShape</code> function is executed every 500 miliseconds (half a second). The <code>setTimeout</code> function only executes once after the set amount of time.</p>
<p>如果你不需要任何交互操作，用 <code>setInterval</code> 方法定时执行重绘是最适合的了。在上面的例子（leegorous不见了？）里 <code>animateShape </code>方法每半秒执行一次。<code>setTimeout</code> 方法只会在预设时间点上执行操作。</p>
<p>The second method we can use to control an animation is user input. If we wanted to make a game we could use keyboard or mouse events to control the animation. By setting eventListeners we catch any user interaction and execute our animation functions.</p>
<p>第二个方法，我们可以利用用户输入来实现操控。如果需要做一个游戏，我们可以通过监听用户交互过程中触发的事件（如 keyboard，mouse）来控制动画效果。</p>
<p>In the examples below I'm using the first method to control the animation. At the bottom of this page are some links to examples which use the second.</p>
<p>下面的例子，我还使用第一种方式实现动画效果。页面底部有些链接，那些是应用第二种方法的例子。</p>
<h4 id=".E5.8A.A8.E7.94.BB.E4.BE.8B.E5.AD.90_1">动画例子 1</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/53/=Canvas_animation1.png">In this example I'm going to animate a mini simulation of our solar system.</p>
<p>这个例子里面，我会让一个小型的太阳系模拟系统动起来。</p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> sun <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> moon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> earth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">init<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  sun<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'images/sun.png'</span><span class="token punctuation">;</span>
  moon<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'images/moon.png'</span><span class="token punctuation">;</span>
  earth<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'images/earth.png'</span><span class="token punctuation">;</span>
  <span class="token function">setInterval<span class="token punctuation">(</span></span>draw<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">'destination-over'</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // clear canvas
</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'rgba(0,0,0,0.4)'</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'rgba(0,153,255,0.4)'</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Earth
</span>  <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token operator">*</span>time<span class="token punctuation">.</span><span class="token function">getSeconds<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60000</span><span class="token punctuation">)</span><span class="token operator">*</span>time<span class="token punctuation">.</span><span class="token function">getMilliseconds<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Shadow
</span>  ctx<span class="token punctuation">.</span><span class="token function">drawImage<span class="token punctuation">(</span></span>earth<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Moon
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">*</span>time<span class="token punctuation">.</span><span class="token function">getSeconds<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6000</span><span class="token punctuation">)</span><span class="token operator">*</span>time<span class="token punctuation">.</span><span class="token function">getMilliseconds<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">28.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">drawImage<span class="token punctuation">(</span></span>moon<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3.5</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">arc<span class="token punctuation">(</span></span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Earth orbit
</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  ctx<span class="token punctuation">.</span><span class="token function">drawImage<span class="token punctuation">(</span></span>sun<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style="top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class="line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div><div class="line-number" data-start="26" style="top: 475px;"></div><div class="line-number" data-start="27" style="top: 494px;"></div><div class="line-number" data-start="28" style="top: 513px;"></div><div class="line-number" data-start="29" style="top: 532px;"></div><div class="line-number" data-start="30" style="top: 551px;"></div><div class="line-number" data-start="31" style="top: 570px;"></div><div class="line-number" data-start="32" style="top: 589px;"></div><div class="line-number" data-start="33" style="top: 608px;"></div><div class="line-number" data-start="34" style="top: 627px;"></div><div class="line-number" data-start="35" style="top: 646px;"></div><div class="line-number" data-start="36" style="top: 665px;"></div><div class="line-number" data-start="37" style="top: 684px;"></div><div class="line-number" data-start="38" style="top: 703px;"></div><div class="line-number" data-start="39" style="top: 722px;"></div><div class="line-number" data-start="40" style="top: 741px;"></div><div class="line-number" data-start="41" style="top: 760px;"></div><div class="line-number" data-start="42" style="top: 779px;"></div><div class="line-number" data-start="43" style="top: 798px;"></div></code></pre>
<table class="gallery"> <tbody> <tr> <td> <div class="gallerybox" style="width: 150px;"> <div style="">Canvas sun.png</div> <div class="gallerytext"> <p>source image sun</p> </div> </div> </td> <td> <div class="gallerybox" style="width: 150px;"> <div style="">Canvas earth.png</div> <div class="gallerytext"> <p>source image earth</p> </div> </div> </td> <td> <div class="gallerybox" style="width: 150px;"> <div style="">Canvas moon.png</div> <div class="gallerytext"> <p>source image moon</p> </div> </div> </td> </tr> </tbody>
</table>
<h4 id=".E5.8A.A8.E7.94.BB.E4.BE.8B.E5.AD.90_2">动画例子 2</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/54/=Canvas_animation2.png"></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">init<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">clock<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setInterval<span class="token punctuation">(</span></span>clock<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">clock<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span><span class="token operator">-</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">"round"</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Hour marks
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">moveTo<span class="token punctuation">(</span></span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">lineTo<span class="token punctuation">(</span></span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Minute marks
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">60</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">%</span><span class="token number">5</span><span class="token operator">!</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">moveTo<span class="token punctuation">(</span></span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">lineTo<span class="token punctuation">(</span></span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">var</span> sec <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getSeconds<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> min <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMinutes<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> hr  <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getHours<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hr <span class="token operator">=</span> hr<span class="token operator">&gt;</span><span class="token operator">=</span><span class="token number">12</span> <span class="token operator">?</span> hr<span class="token number">-12</span> <span class="token punctuation">:</span> hr<span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // write Hours
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span> hr<span class="token operator">*</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token operator">*</span>min <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">21600</span><span class="token punctuation">)</span><span class="token operator">*</span>sec <span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo<span class="token punctuation">(</span></span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo<span class="token punctuation">(</span></span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // write Minutes
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token operator">*</span>min <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token operator">*</span>sec <span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo<span class="token punctuation">(</span></span><span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo<span class="token punctuation">(</span></span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
 <span class="token comment" spellcheck="true"> // Write seconds
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span>sec <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#D40000"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#D40000"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo<span class="token punctuation">(</span></span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo<span class="token punctuation">(</span></span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">arc<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">arc<span class="token punctuation">(</span></span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#555"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">arc<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'#325FA2'</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">arc<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">142</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style="top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class="line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div><div class="line-number" data-start="26" style="top: 475px;"></div><div class="line-number" data-start="27" style="top: 494px;"></div><div class="line-number" data-start="28" style="top: 513px;"></div><div class="line-number" data-start="29" style="top: 532px;"></div><div class="line-number" data-start="30" style="top: 551px;"></div><div class="line-number" data-start="31" style="top: 570px;"></div><div class="line-number" data-start="32" style="top: 589px;"></div><div class="line-number" data-start="33" style="top: 608px;"></div><div class="line-number" data-start="34" style="top: 627px;"></div><div class="line-number" data-start="35" style="top: 646px;"></div><div class="line-number" data-start="36" style="top: 665px;"></div><div class="line-number" data-start="37" style="top: 684px;"></div><div class="line-number" data-start="38" style="top: 703px;"></div><div class="line-number" data-start="39" style="top: 722px;"></div><div class="line-number" data-start="40" style="top: 741px;"></div><div class="line-number" data-start="41" style="top: 760px;"></div><div class="line-number" data-start="42" style="top: 779px;"></div><div class="line-number" data-start="43" style="top: 798px;"></div><div class="line-number" data-start="44" style="top: 817px;"></div><div class="line-number" data-start="45" style="top: 836px;"></div><div class="line-number" data-start="46" style="top: 855px;"></div><div class="line-number" data-start="47" style="top: 874px;"></div><div class="line-number" data-start="48" style="top: 893px;"></div><div class="line-number" data-start="49" style="top: 912px;"></div><div class="line-number" data-start="50" style="top: 931px;"></div><div class="line-number" data-start="51" style="top: 950px;"></div><div class="line-number" data-start="52" style="top: 969px;"></div><div class="line-number" data-start="53" style="top: 988px;"></div><div class="line-number" data-start="54" style="top: 1007px;"></div><div class="line-number" data-start="55" style="top: 1026px;"></div><div class="line-number" data-start="56" style="top: 1045px;"></div><div class="line-number" data-start="57" style="top: 1064px;"></div><div class="line-number" data-start="58" style="top: 1083px;"></div><div class="line-number" data-start="59" style="top: 1102px;"></div><div class="line-number" data-start="60" style="top: 1121px;"></div><div class="line-number" data-start="61" style="top: 1140px;"></div><div class="line-number" data-start="62" style="top: 1159px;"></div><div class="line-number" data-start="63" style="top: 1178px;"></div><div class="line-number" data-start="64" style="top: 1197px;"></div><div class="line-number" data-start="65" style="top: 1216px;"></div><div class="line-number" data-start="66" style="top: 1235px;"></div><div class="line-number" data-start="67" style="top: 1254px;"></div><div class="line-number" data-start="68" style="top: 1273px;"></div><div class="line-number" data-start="69" style="top: 1292px;"></div><div class="line-number" data-start="70" style="top: 1311px;"></div><div class="line-number" data-start="71" style="top: 1330px;"></div><div class="line-number" data-start="72" style="top: 1349px;"></div><div class="line-number" data-start="73" style="top: 1368px;"></div><div class="line-number" data-start="74" style="top: 1387px;"></div><div class="line-number" data-start="75" style="top: 1406px;"></div><div class="line-number" data-start="76" style="top: 1425px;"></div><div class="line-number" data-start="77" style="top: 1444px;"></div><div class="line-number" data-start="78" style="top: 1463px;"></div><div class="line-number" data-start="79" style="top: 1482px;"></div><div class="line-number" data-start="80" style="top: 1501px;"></div><div class="line-number" data-start="81" style="top: 1520px;"></div><div class="line-number" data-start="82" style="top: 1539px;"></div><div class="line-number" data-start="83" style="top: 1558px;"></div><div class="line-number" data-start="84" style="top: 1577px;"></div><div class="line-number" data-start="85" style="top: 1596px;"></div><div class="line-number" data-start="86" style="top: 1615px;"></div><div class="line-number" data-start="87" style="top: 1634px;"></div><div class="line-number" data-start="88" style="top: 1653px;"></div><div class="line-number" data-start="89" style="top: 1672px;"></div><div class="line-number" data-start="90" style="top: 1691px;"></div><div class="line-number" data-start="91" style="top: 1710px;"></div><div class="line-number" data-start="92" style="top: 1729px;"></div><div class="line-number" data-start="93" style="top: 1748px;"></div><div class="line-number" data-start="94" style="top: 1767px;"></div><div class="line-number" data-start="95" style="top: 1786px;"></div><div class="line-number" data-start="96" style="top: 1805px;"></div><div class="line-number" data-start="97" style="top: 1824px;"></div><div class="line-number" data-start="98" style="top: 1843px;"></div></code></pre><h4 id=".E5.8A.A8.E7.94.BB.E4.BE.8B.E5.AD.90_3">动画例子 3</h4>
<p>This is the code for a left-to-right looping panoramic image scroller. Make sure the image is larger than the canvas.</p>
<p>这是一个从左到右滚动的全景动画的代码。请注意图片的大小需要比 canvas 大。</p>
<p>本例中用的是这张图片：<br>
<a class="external" href="http://commons.wikimedia.org/wiki/File:Capitan_Meadows,_Yosemite_National_Park.jpg" title="http://commons.wikimedia.org/wiki/File:Capitan_Meadows,_Yosemite_National_Park.jpg">http://commons.wikimedia.org/wiki/File:Capitan_Meadows,_Yosemite_National_Park.jpg</a></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
//User Variables
</span>img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'Capitan_Meadows,_Yosemite_National_Park.jpg'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> CanvasXSize <span class="token operator">=</span> <span class="token number">800</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> CanvasYSize <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> speed <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> //lower is faster
</span><span class="token keyword">var</span> scale <span class="token operator">=</span> <span class="token number">1.05</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4.5</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> //vertical offset
</span><span class="token comment" spellcheck="true">//End User Variables
</span>
<span class="token keyword">var</span> dx <span class="token operator">=</span> <span class="token number">0.75</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> imgW <span class="token operator">=</span> img<span class="token punctuation">.</span>width<span class="token operator">*</span>scale<span class="token punctuation">;</span>
<span class="token keyword">var</span> imgH <span class="token operator">=</span> img<span class="token punctuation">.</span>height<span class="token operator">*</span>scale<span class="token punctuation">;</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>imgW <span class="token operator">&gt;</span> CanvasXSize<span class="token punctuation">)</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> CanvasXSize<span class="token operator">-</span>imgW<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true"> // image larger than canvas
</span><span class="token keyword">var</span> clearX<span class="token punctuation">;</span>
<span class="token keyword">var</span> clearY<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>imgW <span class="token operator">&gt;</span> CanvasXSize<span class="token punctuation">)</span> <span class="token punctuation">{</span> clearX <span class="token operator">=</span> imgW<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true"> // image larger than canvas
</span><span class="token keyword">else</span> <span class="token punctuation">{</span> clearX <span class="token operator">=</span> CanvasXSize<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>imgH <span class="token operator">&gt;</span> CanvasYSize<span class="token punctuation">)</span> <span class="token punctuation">{</span> clearY <span class="token operator">=</span> imgH<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true"> // image larger than canvas
</span><span class="token keyword">else</span> <span class="token punctuation">{</span> clearY <span class="token operator">=</span> CanvasYSize<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> ctx<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">init<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true"> //Get Canvas Element
</span>    ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment" spellcheck="true"> //Set Refresh Rate
</span>    <span class="token keyword">return</span> <span class="token function">setInterval<span class="token punctuation">(</span></span>draw<span class="token punctuation">,</span> speed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true"> //Clear Canvas
</span>    ctx<span class="token punctuation">.</span><span class="token function">clearRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>clearX<span class="token punctuation">,</span>clearY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment" spellcheck="true"> //If image is &lt;= Canvas Size
</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>imgW <span class="token operator">&lt;</span><span class="token operator">=</span> CanvasXSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment" spellcheck="true"> //reset, start from beginning
</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token punctuation">(</span>CanvasXSize<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
       <span class="token comment" spellcheck="true"> //draw aditional image
</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token punctuation">(</span>CanvasXSize<span class="token operator">-</span>imgW<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ctx<span class="token punctuation">.</span><span class="token function">drawImage<span class="token punctuation">(</span></span>img<span class="token punctuation">,</span>x<span class="token operator">-</span>CanvasXSize<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>y<span class="token punctuation">,</span>imgW<span class="token punctuation">,</span>imgH<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   <span class="token comment" spellcheck="true"> //If image is &gt; Canvas Size
</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>
       <span class="token comment" spellcheck="true"> //reset, start from beginning
</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token punctuation">(</span>CanvasXSize<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> CanvasXSize<span class="token operator">-</span>imgW<span class="token punctuation">;</span> <span class="token punctuation">}</span>
       <span class="token comment" spellcheck="true"> //draw aditional image
</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token punctuation">(</span>CanvasXSize<span class="token operator">-</span>imgW<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ctx<span class="token punctuation">.</span><span class="token function">drawImage<span class="token punctuation">(</span></span>img<span class="token punctuation">,</span>x<span class="token operator">-</span>imgW<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>y<span class="token punctuation">,</span>imgW<span class="token punctuation">,</span>imgH<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   <span class="token comment" spellcheck="true"> //draw image
</span>    ctx<span class="token punctuation">.</span><span class="token function">drawImage<span class="token punctuation">(</span></span>img<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>imgW<span class="token punctuation">,</span>imgH<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment" spellcheck="true"> //amount to move
</span>    x <span class="token operator">+</span><span class="token operator">=</span> dx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style="top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class="line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div><div class="line-number" data-start="26" style="top: 475px;"></div><div class="line-number" data-start="27" style="top: 494px;"></div><div class="line-number" data-start="28" style="top: 513px;"></div><div class="line-number" data-start="29" style="top: 532px;"></div><div class="line-number" data-start="30" style="top: 551px;"></div><div class="line-number" data-start="31" style="top: 570px;"></div><div class="line-number" data-start="32" style="top: 589px;"></div><div class="line-number" data-start="33" style="top: 608px;"></div><div class="line-number" data-start="34" style="top: 627px;"></div><div class="line-number" data-start="35" style="top: 646px;"></div><div class="line-number" data-start="36" style="top: 665px;"></div><div class="line-number" data-start="37" style="top: 684px;"></div><div class="line-number" data-start="38" style="top: 703px;"></div><div class="line-number" data-start="39" style="top: 722px;"></div><div class="line-number" data-start="40" style="top: 741px;"></div><div class="line-number" data-start="41" style="top: 760px;"></div><div class="line-number" data-start="42" style="top: 779px;"></div><div class="line-number" data-start="43" style="top: 798px;"></div><div class="line-number" data-start="44" style="top: 817px;"></div><div class="line-number" data-start="45" style="top: 836px;"></div><div class="line-number" data-start="46" style="top: 855px;"></div><div class="line-number" data-start="47" style="top: 874px;"></div><div class="line-number" data-start="48" style="top: 893px;"></div><div class="line-number" data-start="49" style="top: 912px;"></div><div class="line-number" data-start="50" style="top: 931px;"></div><div class="line-number" data-start="51" style="top: 950px;"></div><div class="line-number" data-start="52" style="top: 969px;"></div><div class="line-number" data-start="53" style="top: 988px;"></div></code></pre>
<p>html code. Canvas width and height should match the CanvasXSize, CanvasYSize.</p>
<pre class="brush: html  language-html" data-number=""><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>init();<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>canvas<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>800<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre>
<h2 id=".E5.85.B6.E5.AE.83.E4.BE.8B.E5.AD.90">其它例子</h2>
<ul> <li><a class="external" href="http://iterationsix.com/particle_fountain/particle_fountain.html" title="http://iterationsix.com/particle_fountain/particle_fountain.html">粒子喷泉 (Particle Fountain)</a><br> 你可以用鼠标来控制物理粒子的产生。</li> <li><a class="external" href="http://www.abrahamjoffe.com.au/ben/canvascape/">Canvascape</a><br> 一个 3D （第一人称射击）冒险游戏。</li> <li><a class="external" href="http://www.gradius-js.com/" title="http://www.gradius-js.com/">http://www.gradius-js.com</a><br> 一个经典的 2D 太空射击游戏。</li> <li><a href="/en/A_Basic_RayCaster" title="en/A_Basic_RayCaster">A Basic RayCaster</a><br> 怎样使用键盘操控动画效果的好例子。</li> <li><a class="external" href="http://andrewwooldridge.com/canvas/canvasgame001/canvasgame002.html">canvas adventure</a><br> 同样是一个键盘操控动画的好例子。</li> <li><a class="external" href="http://www.blobsallad.se/">An interactive Blob</a><br> 有趣的泡泡。</li> <li><a class="external" href="http://arapehlivanian.com/wp-content/uploads/2007/02/canvas.html">Flying through a starfield</a><br> 在星星，圆圈，方块间滑翔。</li> <li><a class="external" href="http://igrapher.com/" title="http://igrapher.com/">iGrapher</a><br> 股票数据图表的例子。</li>
</ul>
<p></p><div class="prevnext" style="text-align: right;"> 
    <p><a href="/zh-CN/docs/Canvas_tutorial:Compositing" style="float: left;">« 上一页</a><a class="new" href="/zh-CN/docs/Canvas_tutorial:Wrapping_up">下一页  »</a></p> 
</div> 下页应该导向《概括总结》，不过还没写，所有下页会导向一个编辑页面。<p></p>
<p></p>
                                    </article>