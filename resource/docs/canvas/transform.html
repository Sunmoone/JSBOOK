<article id="wikiArticle">
                                          <p>&nbsp;</p>
<p>&nbsp;</p>
<h2 id=".E7.8A.B6.E6.80.81.E7.9A.84.E4.BF.9D.E5.AD.98.E5.92.8C.E6.81.A2.E5.A4.8D_Saving_and_restoring_state">状态的保存和恢复 Saving and restoring state</h2>
<p>Before we look at the transformation methods, I'll introduce two other methods which are indispensable once you start generating ever more complex drawings.</p>
<p>在了解变形之前，我先介绍一下两个在你开始绘制复杂图形就必不可少的方法。</p>
<div style="border: 1px solid rgb(208, 221, 158); background: rgb(239, 248, 206) none repeat scroll 0% 0%; padding-left: 10px;"> <p><code><strong>save()</strong></code><br> <code><strong>restore()</strong></code></p>
</div>
<p>The canvas <code>save</code> and <code>restore</code> methods are used to save and retrieve the canvas state. The canvas drawing state is basically a snapshot of all the styles and transformations that have been applied. Both methods take no parameters.<br> <code>save</code> 和 <code>restore</code> 方法是用来保存和恢复 canvas 状态的，都没有参数。Canvas 的状态就是当前画面应用的所有样式和变形的一个快照。</p>
<p>Canvas states are stored on a stack. Every time the <code>save</code> method is called, the current drawing state is pushed onto the stack. A drawing state consists of<br> Canvas 状态是以堆(stack)的方式保存的，每一次调用 <code>save </code>方法，当前的状态就会被推入堆中保存起来。这种状态包括：</p>
<ul> <li>The transformations that have been applied (i.e. translate, rotate and scale - see below).<br> 当前应用的变形（即移动，旋转和缩放，见下）</li> <li>The values of <code>strokeStyle</code>, <code>fillStyle</code>, <code>globalAlpha</code>, <code>lineWidth</code>, <code>lineCap</code>, <code>lineJoin</code>, <code>miterLimit</code>, <code>shadowOffsetX</code>, <code>shadowOffsetY</code>, <code>shadowBlur</code>, <code>shadowColor</code>, <code>globalCompositeOperation</code> properties.<br> <code>strokeStyle</code>, <code>fillStyle</code>, <code>globalAlpha</code>, <code>lineWidth</code>, <code>lineCap</code>, <code>lineJoin</code>, <code>miterLimit</code>, <code>shadowOffsetX</code>, <code>shadowOffsetY</code>, <code>shadowBlur</code>, <code>shadowColor</code>, <code>globalCompositeOperation 的值</code></li> <li>The current clipping path, which we'll see in the next section.<br> 当前的裁切路径（clipping path），会在下一节介绍</li>
</ul>
<p>You can call the <code>save</code> method as many times as you like.<br> 你可以调用任意多次 <code>save </code>方法。</p>
<p>Every time the <code>restore</code> method is called, the last saved state is returned from the stack and all saved settings are restored.<br> 每一次调用 <code>restore </code>方法，上一个保存的状态就从堆中弹出，所有设定都恢复。</p>
<h4 id="save_.E5.92.8C_restore_.E7.9A.84.E5.BA.94.E7.94.A8.E4.BE.8B.E5.AD.90">save 和 restore 的应用例子</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/104/=Canvas_savestate.png">This example tries to illustrate how the stack of drawing states functions by drawing a set of consecutive rectangles.<br> 我们尝试用这个连续矩形的例子来描述 canvas 的状态堆是如何工作的。</p>
<p>The first step is to draw a large rectangle with the default settings. Next we save this state and make changes to the fill color. We then draw the second and smaller blue rectangle and save the state. Again we change some drawing settings and draw the third semi-transparent white rectangle.<br> 第一步是用默认设置画一个大四方形，然后保存一下状态。改变填充颜色画第二个小一点的蓝色四方形，然后再保存一下状态。再次改变填充颜色绘制更小一点的半透明的白色四方形。</p>
<p>So far this is pretty similar to what we've done in previous sections. However once we call the first <code>restore</code> statement, the top drawing state is removed from the stack, and settings are restored. If we hadn't saved the state using <code>save</code>, we would need to change the fill color and transparency manually in order to return to the previous state. This would be easy for two properties, but if we have more than that, our code would become very long, very fast.<br> 到目前为止所做的动作和前面章节的都很类似。不过一旦我们调用 <code>restore</code>，状态堆中最后的状态会弹出，并恢复所有设置。如果不是之前用 <code>save </code>保存了状态，那么我们就需要手动改变设置来回到前一个状态，这个对于两三个属性的时候还是适用的，一旦多了，我们的代码将会猛涨。</p>
<p>When the second <code>restore</code> statement is called, the original state (the one we set up before the first call to <code>save</code>) is restored and the last rectangle is once again drawn in black.<br> 当第二次调用 <code>restore </code>时，已经恢复到最初的状态，因此最后是再一次绘制出一个黑色的四方形。</p>
<p><a class="external" href="/samples/canvas-tutorial/5_1_canvas_savestate.html" title="samples/canvas-tutorial/5_1_canvas_savestate.html">查看示例</a></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true"> // Draw a rectangle with default settings
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment" spellcheck="true"> // Save the default state
</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#09F'</span>      <span class="token comment" spellcheck="true"> // Make changes to the settings
</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Draw a rectangle with new settings
</span>
  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment" spellcheck="true"> // Save the current state
</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#FFF'</span>      <span class="token comment" spellcheck="true"> // Make changes to the settings
</span>  ctx<span class="token punctuation">.</span>globalAlpha <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>    
  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true"> // Draw a rectangle with new settings
</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true"> // Restore previous state
</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true"> // Draw a rectangle with restored settings
</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true"> // Restore original state
</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true"> // Draw a rectangle with restored settings
</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div></code></pre>
<h2 id=".E7.A7.BB.E5.8A.A8_Translating">移动 Translating</h2>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/85/=Canvas_grid_translate.png">The first of the transformation methods we'll look at is <code>translate</code>. This method is used to move the canvas and its origin to a different point in the grid.</p>
<p>我们先介绍 <code>translate </code>方法，它用来移动 canvas 和它的原点到一个不同的位置。</p>
<div style="border: 1px solid rgb(208, 221, 158); background: rgb(239, 248, 206) none repeat scroll 0% 0%; padding-left: 10px;"> <p><code><strong>translate(x, y)</strong></code></p>
</div>
<p>This method takes two arguments. &lt;var&gt;x&lt;/var&gt; is the amount the canvas is moved to the left or right, and &lt;var&gt;y&lt;/var&gt; is the amount it's moved up or down (illustrated by the image on the right).</p>
<p><code>translate </code>方法接受两个参数。&lt;var&gt;x &lt;/var&gt;是左右偏移量，&lt;var&gt;y&lt;/var&gt; 是上下偏移量，如右图所示。</p>
<p>It's a good idea to save the canvas state before doing any transformations. In most cases, it is just easier to call the <code>restore</code> method than having to do a reverse translation to return to the original state. Also if you're translating inside a loop and don't save and restore the canvas state, you might end up missing part of your drawing, because it was drawn outside the canvas edge.</p>
<p>在做变形之前先保存状态是一个良好的习惯。大多数情况下，调用 restore 方法比手动恢复原先的状态要简单得多。又，如果你是在一个循环中做位移但没有保存和恢复 canvas 的状态，很可能到最后会发现怎么有些东西不见了，那是因为它很可能已经超出 canvas 范围以外了。</p>
<h4 id="translate_.E7.9A.84.E4.BE.8B.E5.AD.90"><code>translate</code> 的例子</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/114/=Canvas_translate.png">This example demonstrates some of the benefits of translating the canvas origin. I've made a function <code>drawSpirograph</code> that draws spirograph patterns. These are drawn around the origin. If I didn't use the <code>translate</code> function, I would only see a quarter of the pattern on the canvas. The <code>translate</code> method also gives me the freedom to place it anywhere on the canvas without having to manually adjust coordinates in the spirograph function. This makes it a little easier to understand and use.</p>
<p>这个例子显示了一些移动 canvas 原点的好处。我创建了一个 <code>drawSpirograph</code> 方法用来绘制螺旋（spirograph）图案，那是围绕原点绘制出来的。如果不使用 <code>translate </code>方法，那么只能看见其中的四分之一。<code>translate </code>同时让我可以任意放置这些图案，而不需要在 spirograph 方法中手工调整坐标值，既好理解也方便使用。</p>
<p>In the <code>draw</code> function I call the <code>drawSpirograph</code> nine times using two <code>for</code> loops. In each loop the canvas is translated, the spirograph is drawn, and the canvas is returned back to its original state.</p>
<p>我在 <code>draw </code>方法中调用 <code>drawSpirograph</code> 方法 9 次，用了 2 层循环。每一次循环，先移动 canvas ，画螺旋图案，然后恢复早原始状态。</p>
<p><a class="external" href="/samples/canvas-tutorial/5_2_canvas_translate.html" title="samples/canvas-tutorial/5_2_canvas_translate.html">查看示例</a></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#9CFF00"</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">50</span><span class="token operator">+</span>j<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token operator">+</span>i<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">20</span><span class="token operator">*</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span>R<span class="token punctuation">,</span>r<span class="token punctuation">,</span>O<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> x1 <span class="token operator">=</span> R<span class="token operator">-</span>O<span class="token punctuation">;</span>
  <span class="token keyword">var</span> y1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> i  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo<span class="token punctuation">(</span></span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">&gt;</span><span class="token number">20000</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> x2 <span class="token operator">=</span> <span class="token punctuation">(</span>R<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos<span class="token punctuation">(</span></span>i<span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>r<span class="token operator">+</span>O<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos<span class="token punctuation">(</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>R<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token operator">/</span>r<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> y2 <span class="token operator">=</span> <span class="token punctuation">(</span>R<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin<span class="token punctuation">(</span></span>i<span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">72</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>r<span class="token operator">+</span>O<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin<span class="token punctuation">(</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>R<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token operator">/</span>r<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span><span class="token function">lineTo<span class="token punctuation">(</span></span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    x1 <span class="token operator">=</span> x2<span class="token punctuation">;</span>
    y1 <span class="token operator">=</span> y2<span class="token punctuation">;</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>x2 <span class="token operator">!</span><span class="token operator">=</span> R<span class="token operator">-</span>O <span class="token operator">&amp;&amp;</span> y2 <span class="token operator">!</span><span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style="top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class="line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div><div class="line-number" data-start="26" style="top: 475px;"></div><div class="line-number" data-start="27" style="top: 494px;"></div><div class="line-number" data-start="28" style="top: 513px;"></div><div class="line-number" data-start="29" style="top: 532px;"></div><div class="line-number" data-start="30" style="top: 551px;"></div></code></pre>
<h2 id=".E6.97.8B.E8.BD.AC_Rotating">旋转 Rotating</h2>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/84/=Canvas_grid_rotate.png">The second transformation method is <code>rotate</code>. We use it to rotate the canvas around the current origin.</p>
<p>第二个介绍 <code>rotate </code>方法，它用于以原点为中心旋转 canvas。</p>
<div style="border: 1px solid rgb(208, 221, 158); background: rgb(239, 248, 206) none repeat scroll 0% 0%; padding-left: 10px;"> <p><code><strong>rotate(angle)</strong></code></p>
</div>
<p>This method only takes one parameter and that's the angle the canvas is rotated by. This is a clockwise rotation measured in radians (illustrated in the image on the right).</p>
<p>这个方法只接受一个参数：旋转的角度(angle)，它是顺时针方向的，以弧度为单位的值。</p>
<p>The rotation center point is always the canvas origin. To change the center point, we will need to move the canvas by using the <code>translate</code> method.</p>
<p>旋转的中心点始终是 canvas 的原点，如果要改变它，我们需要用到 <code>translate </code>方法。</p>
<h4 id="rotate_.E7.9A.84.E4.BE.8B.E5.AD.90"><code>rotate</code> 的例子</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/103/=Canvas_rotate.png">In the example, you can see on the right, I used the <code>rotate</code> method to draw shapes in a circular pattern. You could also have calculated the individual &lt;var&gt;x&lt;/var&gt; and &lt;var&gt;y&lt;/var&gt; coordinates (<code>x = r*Math.cos(a); y = r*Math.sin(a)</code>). In this case it doesn't really matter which method you choose, because we're drawing circles. Calculating the coordinates results in only rotating the center positions of the circles and not the circles themselves, while using <code>rotate</code> results in both, but of course circles look the same no matter how far they are rotated about their centers.</p>
<p>在这个例子里，见右图，我用 <code>rotate </code>方法来画圆并构成圆形图案。当然你也可以分别计算出 &lt;var&gt;x&lt;/var&gt; 和 &lt;var&gt;y&lt;/var&gt; 坐标(<code>x = r*Math.cos(a); y = r*Math.sin(a)</code>)。这里无论用什么方法都无所谓的，因为我们画的是圆。计算坐标的结果只是旋转圆心位置，而不是圆本身。即使用 <code>rotate </code>旋转两者，那些圆看上去还是一样的，不管它们绕中心旋转有多远。</p>
<p>Again we have two loops. The first determines the number of rings, and the second determines the number of dots drawn in each ring. Before drawing each ring, I save the canvas state, so I can easily retrieve it. For each dot that is drawn, I rotate the canvas coordinate space by an angle that is determined by the number of dots in the ring. The innermost circle has six dots, so in each step, I rotate over an angle of 360/6 = 60 degrees. With each additional ring, the number of dots is doubled, and the angle in turn is halved.</p>
<p>这里我们又用到了两层循环。第一层循环决定环的数量，第二层循环决定每环有多少个点。每环开始之前，我都保存一下 canvas 的状态，这样恢复起来方便。每次画圆点，我都以一定夹角来旋转 canvas，而这个夹角则是由环上的圆点数目的决定的。最里层的环有 6 个圆点，这样，每次旋转的夹角就是 360/6 = 60 度。往外每一环的圆点数目是里面一环的 2 倍，那么每次旋转的夹角随之减半。</p>
<p><a class="external" href="/samples/canvas-tutorial/5_3_canvas_rotate.html" title="samples/canvas-tutorial/5_3_canvas_rotate.html">查看示例</a></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true"> // Loop through rings (from inside to out)
</span>    ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'rgb('</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">51</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',255)'</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true"> // draw individual dots
</span>      ctx<span class="token punctuation">.</span><span class="token function">rotate<span class="token punctuation">(</span></span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">arc<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token operator">*</span><span class="token number">12.5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">fill<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div></code></pre>
<h2 id=".E7.BC.A9.E6.94.BE_Scaling">缩放 Scaling</h2>
<p>The next transformation method is scaling. We use it to increase or decrease the units in our canvas grid. This can be used to draw scaled down or enlarged shapes and bitmaps.</p>
<p>接着是缩放。我们用它来增减图形在 canvas 中的像素数目，对形状，位图进行缩小或者放大。</p>
<div style="border: 1px solid rgb(208, 221, 158); background: rgb(239, 248, 206) none repeat scroll 0% 0%; padding-left: 10px;"> <p><code><strong>scale(x, y)</strong></code></p>
</div>
<p>This method takes two parameters. <code>x</code> is the scale factor in the horizontal direction and <code>y</code> is the scale factor in the vertical direction. Both parameters must be positive numbers. Values smaller than 1.0 reduce the unit size and values larger than 1.0 increase the unit size. Setting the scaling factor to precisely 1.0 doesn't affect the unit size.</p>
<p><code>scale </code>方法接受两个参数。x,y 分别是横轴和纵轴的缩放因子，它们都必须是正值。值比 1.0 小表示缩小，比 1.0 大则表示放大，值为 1.0 时什么效果都没有。</p>
<p>By default one unit on the canvas is exactly one pixel. If we apply, for instance, a scaling factor of 0.5, the resulting unit would become 0.5 pixels and so shapes would be drawn at half size. In a similar way setting the scaling factor to 2.0 would increase the unit size and one unit now becomes two pixels. This results in shapes being drawn twice as large.</p>
<p>默认情况下，canvas 的 1 单位就是 1 个像素。举例说，如果我们设置缩放因子是 0.5，1 个单位就变成对应 0.5 个像素，这样绘制出来的形状就会是原先的一半。同理，设置为 2.0 时，1 个单位就对应变成了 2 像素，绘制的结果就是图形放大了 2 倍。</p>
<h4 id="scale_.E7.9A.84.E4.BE.8B.E5.AD.90"><code>scale</code> 的例子</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/105/=Canvas_scale.png">In this last example I've used the spirograph function from one of the previous examples to draw nine shapes with different scaling factors. The top left shape has been drawn with no scaling applied. The yellow shapes to the right both have a uniform scaling factor (the same value for &lt;var&gt;x&lt;/var&gt; and &lt;var&gt;y&lt;/var&gt; parameters). If you look at the code below you'll see that I've used the <code>scale</code> method twice with equal parameter values for the second and third spirograph. Because I didn't restore the canvas state, the third shape is drawn with a scaling factor of 0.75 × 0.75 = 0.5625.</p>
<p>这最后的例子里，我再次启用前面曾经用过的 spirograph 方法，来画 9 个图形，分别赋予不同的缩放因子。左上角的图形是未经缩放的。黄色图案从左到右应用了统一的缩放因子（x 和 y 参数值是一致的）。看下面的代码，你可以发现，我在画第二第三个图案时 <code>scale </code>了两次，中间没有 restore canvas 的状态，因此第三个图案的缩放因子其实是 0.75 × 0.75 = 0.5625。</p>
<p>The second row of blue shapes have a non-uniform scaling applied in a vertical direction. Each of the shapes has the &lt;var&gt;x&lt;/var&gt; scaling factor set to 1.0 which means no scaling. The &lt;var&gt;y&lt;/var&gt; scaling factor is set to 0.75. This results in the three shapes being squashed down. The original circular shape has now become an ellipse. If you look closely you'll see that the line width has also been reduced in the vertical direction.</p>
<p>第二行蓝色图案堆垂直方向应用了不统一的缩放因子，每个图形 x 方向上的缩放因子都是 1.0，意味着不缩放，而 y 方向缩放因子是 0.75，得出来的结果是，图案被依次压扁了。原来的圆形图案变成了椭圆，如果细心观察，还可以发现在垂直方向上的线宽也减少了。</p>
<p>The third row of green shapes is similar to the one above but now I've applied a scaling in the horizontal direction.</p>
<p>第三行的绿色图案与第二行类似，只是缩放限定在横轴方向上了。</p>
<p><a class="external" href="/samples/canvas-tutorial/5_4_canvas_scale.html" title="samples/canvas-tutorial/5_4_canvas_scale.html">查看示例</a></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#fc0"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Uniform scaling
</span>  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> // no scaling
</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">0.75</span><span class="token punctuation">,</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">133.333</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">0.75</span><span class="token punctuation">,</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Non-uniform scaling (y direction)
</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#0cf"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true"> // Non-uniform scaling (x direction)
</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#cf0"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">save<span class="token punctuation">(</span></span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">0.75</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">133.333</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">0.75</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">177.777</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">scale<span class="token punctuation">(</span></span><span class="token number">0.75</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drawSpirograph<span class="token punctuation">(</span></span>ctx<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">restore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style="top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class="line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div><div class="line-number" data-start="26" style="top: 475px;"></div><div class="line-number" data-start="27" style="top: 494px;"></div><div class="line-number" data-start="28" style="top: 513px;"></div><div class="line-number" data-start="29" style="top: 532px;"></div><div class="line-number" data-start="30" style="top: 551px;"></div><div class="line-number" data-start="31" style="top: 570px;"></div><div class="line-number" data-start="32" style="top: 589px;"></div><div class="line-number" data-start="33" style="top: 608px;"></div><div class="line-number" data-start="34" style="top: 627px;"></div><div class="line-number" data-start="35" style="top: 646px;"></div><div class="line-number" data-start="36" style="top: 665px;"></div><div class="line-number" data-start="37" style="top: 684px;"></div><div class="line-number" data-start="38" style="top: 703px;"></div><div class="line-number" data-start="39" style="top: 722px;"></div><div class="line-number" data-start="40" style="top: 741px;"></div><div class="line-number" data-start="41" style="top: 760px;"></div><div class="line-number" data-start="42" style="top: 779px;"></div><div class="line-number" data-start="43" style="top: 798px;"></div><div class="line-number" data-start="44" style="top: 817px;"></div><div class="line-number" data-start="45" style="top: 836px;"></div><div class="line-number" data-start="46" style="top: 855px;"></div><div class="line-number" data-start="47" style="top: 874px;"></div><div class="line-number" data-start="48" style="top: 893px;"></div><div class="line-number" data-start="49" style="top: 912px;"></div><div class="line-number" data-start="50" style="top: 931px;"></div><div class="line-number" data-start="51" style="top: 950px;"></div><div class="line-number" data-start="52" style="top: 969px;"></div><div class="line-number" data-start="53" style="top: 988px;"></div></code></pre>
<h2 id=".E5.8F.98.E5.BD.A2_Transforms">变形 Transforms</h2>
<p>The final transformation methods allow modifications directly to the transformation matrix.</p>
<p>最后一个方法是允许直接对变形矩阵作修改。</p>
<div style="border: 1px solid rgb(208, 221, 158); background: rgb(239, 248, 206) none repeat scroll 0% 0%; padding-left: 10px;"> <p><code><strong>transform(m11, m12, m21, m22, dx, dy)</strong></code></p>
</div>
<p>This method must multiply the current transformation matrix with the matrix described by:</p>
<p>这个方法必须将当前的变形矩阵乘上下面的矩阵：</p>
<pre class="language-html">m11 	m21 	dx
m12 	m22 	dy
0 	0 	1
</pre>
<p>If any of the arguments are Infinity the transformation matrix must be marked as infinite instead of the method throwing an exception.</p>
<p>如果任意一个参数是无限大，变形矩阵也必须被标记为无限大，否则会抛出异常。</p>
<div style="border: 1px solid rgb(208, 221, 158); background: rgb(239, 248, 206) none repeat scroll 0% 0%; padding-left: 10px;"> <p><code><strong>setTransform(m11, m12, m21, m22, dx, dy)</strong></code></p>
</div>
<p>This method must reset the current transform to the identity matrix, and then invoke the <code><strong>transform</strong></code> method with the same arguments. If any of the arguments are Infinity the transformation matrix must be marked as infinite instead of the method throwing an exception.</p>
<p>这个方法必须重置当前的变形矩阵为单位矩阵，然后以相同的参数调用 <code>transform </code>方法。如果任意一个参数是无限大，那么变形矩阵也必须被标记为无限大，否则会抛出异常。</p>
<h4 id="transform_.2F_setTransform_.E7.9A.84.E4.BE.8B.E5.AD.90"><code>transform</code> / <code>setTransform</code> 的例子</h4>
<p><img align="right" alt="" class="internal" src="/@api/deki/files/111/=Canvas_transform.png" style=""></p>
<pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">draw<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext<span class="token punctuation">(</span></span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> sin <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin<span class="token punctuation">(</span></span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> cos <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos<span class="token punctuation">(</span></span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">translate<span class="token punctuation">(</span></span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span><span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    c <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor<span class="token punctuation">(</span></span><span class="token number">255</span> <span class="token operator">/</span> <span class="token number">12</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"rgb("</span> <span class="token operator">+</span> c <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> c <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> c <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">transform<span class="token punctuation">(</span></span>cos<span class="token punctuation">,</span> sin<span class="token punctuation">,</span> <span class="token operator">-</span>sin<span class="token punctuation">,</span> cos<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  ctx<span class="token punctuation">.</span><span class="token function">setTransform<span class="token punctuation">(</span></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"rgba(255, 128, 255, 0.5)"</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div></code></pre>
<p><br> </p><div class="prevnext" style="text-align: right;"> 
    <p><a href="/zh-CN/docs/Canvas_tutorial:Applying_styles_and_colors" style="float: left;">« 上一页</a><a href="/zh-CN/docs/Canvas_tutorial/Compositing">下一页  »</a></p> 
</div><p></p>
<p></p>
                                    </article>