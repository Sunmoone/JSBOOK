<div class="_page _node"><h1 id="readline_readline">Readline</h1> <pre class="api_stability_2">Stability: 2 - Unstable</pre>
<p>To use this module, do <code>require('readline')</code>. Readline allows reading of a stream (such as <code>process.stdin</code>) on a line-by-line basis. </p> <p>Note that once you've invoked this module, your node program will not terminate until you've closed the interface. Here's how to allow your program to gracefully exit: </p> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> readline <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'readline'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> rl <span class="token operator">=</span> readline<span class="token punctuation">.</span><span class="token function">createInterface<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  input<span class="token punctuation">:</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> process<span class="token punctuation">.</span>stdout
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rl<span class="token punctuation">.</span><span class="token function">question<span class="token punctuation">(</span></span><span class="token string">"What do you think of node.js? "</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true"> // TODO: Log the answer in a database
</span>  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">"Thank you for your valuable feedback:"</span><span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  rl<span class="token punctuation">.</span><span class="token function">close<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="readline_readline_createinterface_options">readline.createInterface(options)</h2> <p>Creates a readline <code>Interface</code> instance. Accepts an "options" Object that takes the following values: </p> <ul>
<li>
<p><code>input</code> - the readable stream to listen to (Required).</p> </li> <li>
<p><code>output</code> - the writable stream to write readline data to (Required).</p> </li> <li>
<p><code>completer</code> - an optional function that is used for Tab autocompletion. See below for an example of using this.</p> </li> <li>
<p><code>terminal</code> - pass <code>true</code> if the <code>input</code> and <code>output</code> streams should be treated like a TTY, and have ANSI/VT100 escape codes written to it. Defaults to checking <code>isTTY</code> on the <code>output</code> stream upon instantiation.</p> </li> </ul>
<p>The <code>completer</code> function is given a the current line entered by the user, and is supposed to return an Array with 2 entries: </p> <ol>
<li>
<p>An Array with matching entries for the completion.</p> </li> <li>
<p>The substring that was used for the matching.</p> </li> </ol>
<p>Which ends up looking something like: <code>[[substr1, substr2, ...], originalsubstring]</code>. </p> <p>Example: </p> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">completer<span class="token punctuation">(</span></span>line<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> completions <span class="token operator">=</span> <span class="token string">'.help .error .exit .quit .q'</span><span class="token punctuation">.</span><span class="token function">split<span class="token punctuation">(</span></span><span class="token string">' '</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> hits <span class="token operator">=</span> completions<span class="token punctuation">.</span><span class="token function">filter<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">indexOf<span class="token punctuation">(</span></span>line<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token comment" spellcheck="true"> // show all completions if none found
</span>  <span class="token keyword">return</span> <span class="token punctuation">[</span>hits<span class="token punctuation">.</span>length <span class="token operator">?</span> hits <span class="token punctuation">:</span> completions<span class="token punctuation">,</span> line<span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre> <p>Also <code>completer</code> can be run in async mode if it accepts two arguments: </p> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">completer<span class="token punctuation">(</span></span>linePartial<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">callback<span class="token punctuation">(</span></span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'123'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> linePartial<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p><code>createInterface</code> is commonly used with <code>process.stdin</code> and <code>process.stdout</code> in order to accept user input: </p> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> readline <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'readline'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> rl <span class="token operator">=</span> readline<span class="token punctuation">.</span><span class="token function">createInterface<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  input<span class="token punctuation">:</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> process<span class="token punctuation">.</span>stdout
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>Once you have a readline instance, you most commonly listen for the <code>"line"</code> event. </p> <p>If <code>terminal</code> is <code>true</code> for this instance then the <code>output</code> stream will get the best compatibility if it defines an <code>output.columns</code> property, and fires a <code>"resize"</code> event on the <code>output</code> if/when the columns ever change (<code>process.stdout</code> does this automatically when it is a TTY). </p> <h2 id="readline_class_interface">Class: Interface</h2> <p>The class that represents a readline interface with an input and output stream. </p> <h3 id="readline_rl_setprompt_prompt_length">rl.setPrompt(prompt, length)</h3> <p>Sets the prompt, for example when you run <code>node</code> on the command line, you see <code>&gt; </code>, which is node's prompt. </p> <h3 id="readline_rl_prompt_preservecursor">rl.prompt([preserveCursor])</h3> <p>Readies readline for input from the user, putting the current <code>setPrompt</code> options on a new line, giving the user a new spot to write. Set <code>preserveCursor</code> to <code>true</code> to prevent the cursor placement being reset to <code>0</code>. </p> <p>This will also resume the <code>input</code> stream used with <code>createInterface</code> if it has been paused. </p> <h3 id="readline_rl_question_query_callback">rl.question(query, callback)</h3> <p>Prepends the prompt with <code>query</code> and invokes <code>callback</code> with the user's response. Displays the query to the user, and then invokes <code>callback</code> with the user's response after it has been typed. </p> <p>This will also resume the <code>input</code> stream used with <code>createInterface</code> if it has been paused. </p> <p>Example usage: </p> <pre class=" language-javascript"><code class=" language-javascript">interface<span class="token punctuation">.</span><span class="token function">question<span class="token punctuation">(</span></span><span class="token string">'What is your favorite food?'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Oh, so your favorite food is '</span> <span class="token operator">+</span> answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h3 id="readline_rl_pause">rl.pause()</h3> <p>Pauses the readline <code>input</code> stream, allowing it to be resumed later if needed. </p> <h3 id="readline_rl_resume">rl.resume()</h3> <p>Resumes the readline <code>input</code> stream. </p> <h3 id="readline_rl_close">rl.close()</h3> <p>Closes the <code>Interface</code> instance, relinquishing control on the <code>input</code> and <code>output</code> streams. The "close" event will also be emitted. </p> <h3 id="readline_rl_write_data_key">rl.write(data, [key])</h3> <p>Writes <code>data</code> to <code>output</code> stream. <code>key</code> is an object literal to represent a key sequence; available if the terminal is a TTY. </p> <p>This will also resume the <code>input</code> stream if it has been paused. </p> <p>Example: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">write<span class="token punctuation">(</span></span><span class="token string">'Delete me!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">
// Simulate ctrl+u to delete the line written previously
</span>rl<span class="token punctuation">.</span><span class="token function">write<span class="token punctuation">(</span></span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>ctrl<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'u'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="readline_events">Events</h2> <h3 id="readline_event_line">Event: 'line'</h3> <p><code>function (line) {}</code> </p> <p>Emitted whenever the <code>input</code> stream receives a <code>\n</code>, usually received when the user hits enter, or return. This is a good hook to listen for user input. </p> <p>Example of listening for <code>line</code>: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'line'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'You just typed: '</span><span class="token operator">+</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h3 id="readline_event_pause">Event: 'pause'</h3> <p><code>function () {}</code> </p> <p>Emitted whenever the <code>input</code> stream is paused. </p> <p>Also emitted whenever the <code>input</code> stream is not paused and receives the <code>SIGCONT</code> event. (See events <code>SIGTSTP</code> and <code>SIGCONT</code>) </p> <p>Example of listening for <code>pause</code>: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'pause'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Readline paused.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h3 id="readline_event_resume">Event: 'resume'</h3> <p><code>function () {}</code> </p> <p>Emitted whenever the <code>input</code> stream is resumed. </p> <p>Example of listening for <code>resume</code>: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'resume'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Readline resumed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h3 id="readline_event_close" class="">Event: 'close'</h3> <p><code>function () {}</code> </p> <p>Emitted when <code>close()</code> is called. </p> <p>Also emitted when the <code>input</code> stream receives its "end" event. The <code>Interface</code> instance should be considered "finished" once this is emitted. For example, when the <code>input</code> stream receives <code>^D</code>, respectively known as <code>EOT</code>. </p> <p>This event is also called if there is no <code>SIGINT</code> event listener present when the <code>input</code> stream receives a <code>^C</code>, respectively known as <code>SIGINT</code>. </p> <h3 id="readline_event_sigint">Event: 'SIGINT'</h3> <p><code>function () {}</code> </p> <p>Emitted whenever the <code>input</code> stream receives a <code>^C</code>, respectively known as <code>SIGINT</code>. If there is no <code>SIGINT</code> event listener present when the <code>input</code> stream receives a <code>SIGINT</code>, <code>pause</code> will be triggered. </p> <p>Example of listening for <code>SIGINT</code>: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'SIGINT'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  rl<span class="token punctuation">.</span><span class="token function">question<span class="token punctuation">(</span></span><span class="token string">'Are you sure you want to exit?'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>answer<span class="token punctuation">.</span><span class="token function">match<span class="token punctuation">(</span></span><span class="token regex">/^y(es)?$/i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> rl<span class="token punctuation">.</span><span class="token function">pause<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h3 id="readline_event_sigtstp">Event: 'SIGTSTP'</h3> <p><code>function () {}</code> </p> <p><strong>This does not work on Windows.</strong> </p> <p>Emitted whenever the <code>input</code> stream receives a <code>^Z</code>, respectively known as <code>SIGTSTP</code>. If there is no <code>SIGTSTP</code> event listener present when the <code>input</code> stream receives a <code>SIGTSTP</code>, the program will be sent to the background. </p> <p>When the program is resumed with <code>fg</code>, the <code>pause</code> and <code>SIGCONT</code> events will be emitted. You can use either to resume the stream. </p> <p>The <code>pause</code> and <code>SIGCONT</code> events will not be triggered if the stream was paused before the program was sent to the background. </p> <p>Example of listening for <code>SIGTSTP</code>: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'SIGTSTP'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true"> // This will override SIGTSTP and prevent the program from going to the
</span> <span class="token comment" spellcheck="true"> // background.
</span>  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Caught SIGTSTP.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h3 id="readline_event_sigcont">Event: 'SIGCONT'</h3> <p><code>function () {}</code> </p> <p><strong>This does not work on Windows.</strong> </p> <p>Emitted whenever the <code>input</code> stream is sent to the background with <code>^Z</code>, respectively known as <code>SIGTSTP</code>, and then continued with <code>fg(1)</code>. This event only emits if the stream was not paused before sending the program to the background. </p> <p>Example of listening for <code>SIGCONT</code>: </p> <pre class=" language-javascript"><code class=" language-javascript">rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'SIGCONT'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true"> // `prompt` will automatically resume the stream
</span>  rl<span class="token punctuation">.</span><span class="token function">prompt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="readline_example_tiny_cli">Example: Tiny CLI</h2> <p>Here's an example of how to use all these together to craft a tiny command line interface: </p> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> readline <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'readline'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    rl <span class="token operator">=</span> readline<span class="token punctuation">.</span><span class="token function">createInterface<span class="token punctuation">(</span></span>process<span class="token punctuation">.</span>stdin<span class="token punctuation">,</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>

rl<span class="token punctuation">.</span><span class="token function">setPrompt<span class="token punctuation">(</span></span><span class="token string">'OHAI&gt; '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rl<span class="token punctuation">.</span><span class="token function">prompt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rl<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'line'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">switch<span class="token punctuation">(</span></span>line<span class="token punctuation">.</span><span class="token function">trim<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    case <span class="token string">'hello'</span><span class="token punctuation">:</span>
      console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'world!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    default<span class="token punctuation">:</span>
      console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Say what? I might have heard `'</span> <span class="token operator">+</span> line<span class="token punctuation">.</span><span class="token function">trim<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'`'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  rl<span class="token punctuation">.</span><span class="token function">prompt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Have a great day!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  process<span class="token punctuation">.</span><span class="token function">exit<span class="token punctuation">(</span></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><div class="_attribution">
  <p class="_attribution-p">
    © Joyent, Inc. and other Node contributors<br>Licensed under the MIT License.<br>
    <a href="http://nodejs.org/api/readline.html" class="_attribution-link">http://nodejs.org/api/readline.html</a>
  </p>
</div>
</div>