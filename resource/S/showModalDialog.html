<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/Dlonghow/archive/2009/06/04/1496141.html">JS中showModalDialog 详细使用</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><p><span><font size="2" face="Courier New"><span style="color: red">基本介绍：</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; showModalDialog()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (IE 4+ 支持)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; showModelessDialog()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (IE 5+ 支持)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.showModalDialog()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法用来创建一个显示HTML内容的模态对话框。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.showModelessDialog()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法用来创建一个显示HTML内容的非模态对话框。<br><span style="color: red">使用方法：</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vReturnValue = window.showModalDialog(sURL [, vArguments] [,sFeatures])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vReturnValue = window.showModelessDialog(sURL [, vArguments] [,sFeatures])<br><span style="color: red">参数说明：</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sURL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;必选参数，类型：字符串。用来指定对话框要显示的文档的URL。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vArguments&nbsp;&nbsp;&nbsp; --&nbsp;可选参数，类型：变体。用来向对话框传递参数。传递的参数类型不限，包括数组等。对话框通过</font></span><span><font size="2" face="Courier New">&nbsp; </font></span></p>
<p><span><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.dialogArguments来取得传递进来的参数。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sFeatures&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;可选参数，类型：字符串。用来描述对话框的外观等信息，可以使用以下的一个或几个，用分号“;”隔开。<br>----------------<br>1.&nbsp;&nbsp;&nbsp; dialogHeight:&nbsp;&nbsp;&nbsp; 对话框高度，不小于100px<br>2.&nbsp;&nbsp;&nbsp; dialogWidth:&nbsp;&nbsp;&nbsp; 对话框宽度。<br>3.&nbsp;&nbsp;&nbsp; dialogLeft:&nbsp;&nbsp;&nbsp;&nbsp; 离屏幕左的距离。<br>4.&nbsp;&nbsp;&nbsp; dialogTop:&nbsp;&nbsp;&nbsp;&nbsp; 离屏幕上的距离。<br>5.&nbsp;&nbsp;&nbsp; center:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { yes | no | 1 | 0 } ：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 是否居中，默认yes，但仍可以指定高度和宽度。<br>6.&nbsp;&nbsp;&nbsp; help:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {yes | no | 1 | 0 }：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 是否显示帮助按钮，默认yes。<br>7.&nbsp;&nbsp;&nbsp; resizable:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {yes | no | 1 | 0 } [IE5+]：&nbsp;&nbsp;&nbsp;&nbsp; 是否可被改变大小。默认no。<br>8.&nbsp;&nbsp;&nbsp; status:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {yes | no | 1 | 0 } [IE5+]：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 是否显示状态栏。默认为yes[ Modeless]或no[Modal]。<br>9.&nbsp;&nbsp;&nbsp; scroll:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { yes | no | 1 | 0 | on | off }：是否显示滚动条。默认为yes。<br><br>下面几个属性是用在HTA中的，在一般的网页中一般不使用。<br>10.&nbsp;&nbsp;&nbsp; dialogHide:{ yes | no | 1 | 0 | on | off }：在</font><a class="bluekey" href="http://oa.yesky.com/" target="_blank"><font size="2" face="Courier New">打印</font></a><font size="2" face="Courier New">或者打印预览时对话框是否隐藏。默认为no。<br>11.&nbsp;&nbsp;&nbsp; edge:{ sunken | raised }：指明对话框的边框样式。默认为raised。<br>12.&nbsp;&nbsp;&nbsp; unadorned:{ yes | no | 1 | 0 | on | off }：默认为no。<br><br><strong style="color: red">参数传递：</strong><strong><br></strong>1.&nbsp;要想对话框传递参数，是通过vArguments来进行传递的。类型不限制，对于字符串类型，最大为4096个字符。也可以传递对象，例如：<br>-------------------------------<br>parent.htm<br>&lt;script&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var obj = new Object();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.name="51js";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.showModalDialog("modal.htm",obj,"dialogWidth=200px;dialogHeight=100px");<br>&lt;/script&gt;<br>modal.htm<br>&lt;script&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var obj = window.dialogArguments<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert("您传递的参数为：" + obj.name)<br>&lt;/script&gt;<br>-------------------------------<br>2.可以通过window.returnValue向打开对话框的窗口返回信息，当然也可以是对象。例如：<br>------------------------------<br>parent.htm<br>&lt;script&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str =window.showModalDialog("modal.htm",,"dialogWidth=200px;dialogHeight=100px");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(str);<br>&lt;/script&gt;<br>modal.htm<br>&lt;script&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.returnValue="http://homepage.yesky.com";<br>&lt;/script&gt;</font></span><font size="2" face="Courier New"> </font></p>
<p><font size="2" face="Courier New"><strong>常见技巧：</strong></font></p>
<p align="left"><font face="Courier New"><font size="2"><strong>一、怎样才让在showModalDialog和showModelessDialog的超连接不弹出新窗口？</strong><br>　　在被打开的网页里加上&lt;base target="_self"&gt;就可以了。这句话一般是放在&lt;head&gt;之间的。</font></font></p>
<p align="left"><font face="Courier New"><font size="2"><strong>二、怎样才刷新showModalDialog和showModelessDialog里的内容？</strong><br>　　在showModalDialog和showModelessDialog里是不能按F5刷新的，又不能弹出菜单。这个只能依靠</font></font></p>
<p align="left"><font size="2" face="Courier New">javascript了，以下是相关代码：</font></p>
<p align="left"><font size="2" face="Courier New">&lt;body onkeydown="if (event.keyCode==116){reload.click()}"&gt;<br>&lt;a id="reload" href="filename.htm" style="display:none"&gt;reload...&lt;/a&gt;</font></p>
<p align="left"><font size="2" face="Courier New">　　将filename.htm替换成网页的名字然后将它放到你打开的网页里，按F5就可以刷新了，注意，这个要</font></p>
<p align="left"><font size="2" face="Courier New">配合&lt;base target="_self"&gt;使用，不然你按下F5会弹出新窗口的。</font></p>
<p align="left"><font face="Courier New"><font size="2"><strong>三、如何用javascript关掉showModalDialog(或showModelessDialog)打开的窗口。</strong><br>　　&lt;input type="button" value="关闭" onclick="window.close()"&gt;<br>　　也要配合&lt;base target="_self"&gt;，不然会打开一个新的IE窗口，然后再关掉的。</font></font></p>
<p><strong><font size="2" face="Courier New">四、Math.random与showModalDialog。</font></strong></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp; 当你设置的弹出网页固定时（如上面的<font size="2">"modal.htm"页面）</font>，ie很可能到临时文件区，下载上次产生的该页面(openPage.html),而没有重新加载，</font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp; 对于动态加载的页面来说，这样往往产生误会，如没有及时更新数据，也就更不利于开发者测试。所以，你可以采用如下方式：</font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var strPage = “/medal.htm?random="+Math.random();</font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp; 这样每次产生的strPage是不一样的，原因也就不言自明了。</font></p>
<p><font size="2" face="Courier New"></font>&nbsp;</p>
<p><font size="2" face="Courier New"></font><br>&nbsp;</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">

	
	
</div>
